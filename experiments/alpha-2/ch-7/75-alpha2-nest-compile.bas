5 REM ** ALPHA-II COMPILED NEST MASTER **
7 DIMT(10,3)
8 TN=1
10 GOSUB500
12 GOSUB625
15 CLS:GOSUB550
17 NF=0
20 GOSUB580
25 GOSUB600
30 NO=0:GOSUB950
35 X=X+I:Y=Y+J:GOSUB725
40 IFCO=0THEN110
45 IFFL=0THEN85
50 GOSUB990
55 GOSUB725
60 IFCO=1THEN82
65 GOSUB580:GOSUB950
70 NF=NF+1:FORFT=OTO25:SET(X,Y):SET(X+1,Y):RESET(X,Y):RESET(X+1,Y):NEXT
75 GOSUB970
80 NO=100:GOTO85
82 GOSUB580:GOSUB950
85 C=C+1:GOSUB900
87 IFC>=100THEN155ELSEGOSUB800
90 SET(X,Y):SET(X+1,Y):RESET(X,Y):RESET(X+1,Y):GOSUB650
95 I=RI-3:J=RJ-3:GOSUB725
100 IFCO=1THEN85
105 D=D+1:GOSUB800
110 SET(X,Y):SET(X+1,Y):RESET(X,Y):RESET(X+1,Y)
115 IFNO<100THEN135
120 IFNO>=125THEN130
125 NO=NO+1:GOTO35
130 NO=0:GOSUB950
135 IFFL=1THEN145
140 F$=INKEY$:IFF$="F"GOSUB950
142 GOTO35
145 F$=INKEY$:IFF$="X"GOSUB970
150 GOTO35
155 IFTN<=TTHEN15
160 GOSUB875
165 GOTO8
500 REM ** ALPHA-II HEAD-2 **
505 CLS
510 PRINTTAB(25)"IDEAL ALPHA-II":PRINT
515 PRINTTAB(15)" NEST VERSION WITH COMPILE"
517 PRINT:INPUT"HOW MANY TEST CYCLES";T
520 FORL=0TO8:PRINT:NEXT
525 INPUT"DO ENTER TO START";S$:RETURN
550 REM ** FIELD-1 **
552 F1=15553:F2=15615:F3=16321:F4=16383
555 FORF=F1TOF2:POKEF,131:NEXT
560 FORF=F3TOF4:POKEF,176:NEXT
565 FORF=F1TOF4STEP64:POKEF,191:NEXT
570 FORF=F2TOF4STEP64:POKEF,191:NEXT
575 RETURN
580 REM ** NEST FIG-1 **
582 FA=15900:FORF=FA TOFA+7:POKEF,176:NEXT
585 FORF=FA+64TOFA+7:POKEF,191:NEXT
587 FORF=FA+128TOFA+135:POKEF,131:NEXT
590 RETURN
600 REM ** INITIAL COMP-3 **
605 GOSUB650
610 X=RI+25:Y=RJ+25:GOSUB650
612 I=RI-3:J=RJ-3
615 C=0:D=0
620 RETURN
625 REM ** INITIAL COMP-2 **
630 FORN=1TO10:FORM=1TO3:T(N,M)=0:NEXT:NEXT
635 RETURN
650 REM ** FETCH NEW-1 **
660 RI=RND(5):RJ=RND(5)
665 IFRI=3ANDRJ=3THEN660
670 RETURN
725 REM ** CON SENSE-1 **
730 FORXP=2TO2+ABS(I):FORYP=1TO1+ABS(J)
735 IFPOINT(X+SGN(I)*XP,Y+SGN(J)*YP)=-1THEN750
740 NEXT:NEXT
745 CO=0:RETURN
750 CO=1:RETURN
800 REM ** UD NEST-2 *
805 U$="#.###"
845 PRINT@O,"CREAT. NO."
850 PRINT@15,"FEEDS"
852 PRINT@25,"'TACTS"
853 PRINT@35,"OK MOVES"
854 PRINT@47,"FSCOR":PRINT@57,"SCORE"
855 PRINT@64,TN" 0F"T:PRINT@79,NF:PRINT@89,C:PRINT@99,D:PRINT@111,USINGU$;NF/ C:PRINT@121,USINGU$;D/C
865 RETURN
875 REM ** PRINT COMP-2 **
880 CLS:PRINT"COMPILED RESULTS FOR"TN- 1"CYCLES":PRINT:PRINT
883 PRINT"DECADE","SCORE","FEED"
885 FORN=1TO10:FC=T(N,1):FD=T(N,2):FE=T(N,3)
890 PRINTN,:PRINTUSINGU$;FD/FC,:PRINTTAB(32)USINGU$;FE/FC:NEXT
895 INPUT"DONE";X$:RETURN
900 REM ** COMPILE-2 **
905 IFC/10<>INT(C/10)RETURN
910 TF=INT(C/10):T(TF,1)=T(TF,1)+C:T(TF,2)=T(TF,2)+D:T(TF,3)=T(TF,3)+NF
915 IFTF<10RETURN
920 TN=TN+1:RETURN
950 REM ** NEST ON-1 **
955 POKEFA+66,79:POKEFA+67,78:POKEFA+68,128
960 FL=1:RETURN
970 REM ** NEST OFF-1 **
975 POKEFA+66,79:POKEFA+67,70:POKEFA+68,70
980 FL=0:RETURN
990 REM ** NEST BLANK **
992 FORF=FATOFA+7:POKEF,128:NEXT
994 FORF=FA+64TOFA+71:POKEF,128:NEXT
996 FORF=FA+128TOFA+135:POKEF,128:NEXT
998 RETURN